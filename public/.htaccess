# Enable mod_rewrite
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Redirect old WordPress recipe URLs to new structure
  # /recipe/slug → /slug
  RewriteCond %{REQUEST_URI} ^/recipe/
  RewriteRule ^recipe/(.*)$ /$1 [R=301,L]
  
  # Redirect old WordPress posts to new structure
  # /posts/slug → /slug
  RewriteCond %{REQUEST_URI} ^/posts/
  RewriteRule ^posts/(.*)$ /$1 [R=301,L]
  
  # Force HTTPS
  RewriteCond %{HTTPS} off
  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
  
  # Remove www (adjust based on preference)
  RewriteCond %{HTTP_HOST} ^www\. [NC]
  RewriteRule ^(.*)$ https://lacuisinedebernard.com/$1 [R=301,L]
</IfModule>

# Caching headers for static assets
<FilesMatch "\.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$">
  Header set Cache-Control "public, max-age=31536000, immutable"
  Header unset ETag
  FileETag None
</FilesMatch>

# HTML cache (1 day)
<FilesMatch "\.html$">
  Header set Cache-Control "public, max-age=86400"
</FilesMatch>

# Prevent access to sensitive files
<FilesMatch "\.(env|json|lock)$">
  Deny from all
</FilesMatch>
